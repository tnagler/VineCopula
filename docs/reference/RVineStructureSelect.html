<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Sequential Specification of R- and C-Vine Copula Models — RVineStructureSelect • VineCopula</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Sequential Specification of R- and C-Vine Copula Models — RVineStructureSelect"><meta property="og:description" content="This function fits either an R- or a C-vine copula model to a d-dimensional
copula data set. Tree structures are determined and appropriate pair-copula
families are selected using BiCopSelect() and estimated
sequentially (forward selection of trees)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">VineCopula</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.5.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/tnagler/VineCopula/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Sequential Specification of R- and C-Vine Copula Models</h1>
    <small class="dont-index">Source: <a href="https://github.com/tnagler/VineCopula/blob/HEAD/R/RVineStructureSelect.R" class="external-link"><code>R/RVineStructureSelect.R</code></a></small>
    <div class="hidden name"><code>RVineStructureSelect.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function fits either an R- or a C-vine copula model to a d-dimensional
copula data set. Tree structures are determined and appropriate pair-copula
families are selected using <code><a href="BiCopSelect.html">BiCopSelect()</a></code> and estimated
sequentially (forward selection of trees).</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">RVineStructureSelect</span><span class="op">(</span>
  <span class="va">data</span>,
  familyset <span class="op">=</span> <span class="cn">NA</span>,
  type <span class="op">=</span> <span class="fl">0</span>,
  selectioncrit <span class="op">=</span> <span class="st">"AIC"</span>,
  indeptest <span class="op">=</span> <span class="cn">FALSE</span>,
  level <span class="op">=</span> <span class="fl">0.05</span>,
  trunclevel <span class="op">=</span> <span class="cn">NA</span>,
  progress <span class="op">=</span> <span class="cn">FALSE</span>,
  weights <span class="op">=</span> <span class="cn">NA</span>,
  treecrit <span class="op">=</span> <span class="st">"tau"</span>,
  rotations <span class="op">=</span> <span class="cn">TRUE</span>,
  se <span class="op">=</span> <span class="cn">FALSE</span>,
  presel <span class="op">=</span> <span class="cn">TRUE</span>,
  method <span class="op">=</span> <span class="st">"mle"</span>,
  cores <span class="op">=</span> <span class="fl">1</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>data</dt>
<dd><p>An N x d data matrix (with uniform margins).</p></dd>


<dt>familyset</dt>
<dd><p>An integer vector of pair-copula families to select from.
The vector has to include at least one
pair-copula family that allows for positive and one that allows for negative
dependence. Not listed copula families might be included to better handle
limit cases.  If <code>familyset = NA</code> (default), selection among all
possible families is performed.  Coding of pair-copula families is the same
as in <code><a href="BiCop.html">BiCop()</a></code>.</p></dd>


<dt>type</dt>
<dd><p>Type of the vine model to be specified:<br><code>0</code> or <code>"RVine"</code> = R-vine (default) <br><code>1</code> or <code>"CVine"</code> = C-vine <br>
C- and D-vine copula models with pre-specified order can be specified using
<code>CDVineCopSelect</code> of the package CDVine. Similarly, R-vine copula
models with pre-specified tree structure can be specified using
<code><a href="RVineCopSelect.html">RVineCopSelect()</a></code>.</p></dd>


<dt>selectioncrit</dt>
<dd><p>Character indicating the criterion for pair-copula
selection. Possible choices:<code>selectioncrit = "AIC"</code> (default),
<code>"BIC"</code>, or <code>"logLik"</code> (see <code><a href="BiCopSelect.html">BiCopSelect()</a></code>).</p></dd>


<dt>indeptest</dt>
<dd><p>logical; whether a hypothesis test for the independence of
<code>u1</code> and <code>u2</code> is performed before bivariate copula selection
(default: <code>indeptest = FALSE</code>; see <code><a href="BiCopIndTest.html">BiCopIndTest()</a></code>).  The
independence copula is chosen for a (conditional) pair if the null
hypothesis of independence cannot be rejected.</p></dd>


<dt>level</dt>
<dd><p>numeric; significance level of the independence test
(default: <code>level = 0.05</code>).</p></dd>


<dt>trunclevel</dt>
<dd><p>integer; level of truncation.</p></dd>


<dt>progress</dt>
<dd><p>logical; whether the tree-wise specification progress is
printed (default: <code>progress = FALSE</code>).</p></dd>


<dt>weights</dt>
<dd><p>numeric; weights for each observation (optional).</p></dd>


<dt>treecrit</dt>
<dd><p>edge weight for Dissman's structure selection algorithm, see
<em>Details</em>.</p></dd>


<dt>rotations</dt>
<dd><p>If <code>TRUE</code>, all rotations of the families in
<code>familyset</code> are included.</p></dd>


<dt>se</dt>
<dd><p>Logical; whether standard errors are estimated (default: <code>se = FALSE</code>).</p></dd>


<dt>presel</dt>
<dd><p>Logical; whether to exclude families before fitting based on
symmetry properties of the data. Makes the selection about 30\<!-- % faster -->
(on average), but may yield slightly worse results in few special cases.</p></dd>


<dt>method</dt>
<dd><p>indicates the estimation method: either maximum
likelihood estimation (<code>method = "mle"</code>; default) or inversion of
Kendall's tau (<code>method = "itau"</code>). For <code>method = "itau"</code> only
one parameter families and the Student t copula can be used (<code>family = 1,2,3,4,5,6,13,14,16,23,24,26,33,34</code> or <code>36</code>). For the t-copula,
<code>par2</code> is found by a crude profile likelihood optimization over the
interval (2, 10].</p></dd>


<dt>cores</dt>
<dd><p>integer; if <code>cores &gt; 1</code>, estimation will be parallelized
within each tree (using <code><a href="https://rdrr.io/pkg/foreach/man/foreach.html" class="external-link">foreach::foreach()</a></code>). Note that
parallelization causes substantial overhead and may be slower than
single-threaded computation when dimension, sample size, or family set are
small or <code>method = "itau"</code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>An <code><a href="RVineMatrix.html">RVineMatrix()</a></code> object with the selected structure
(<code>RVM$Matrix</code>) and families (<code>RVM$family</code>) as well as sequentially
estimated parameters stored in <code>RVM$par</code> and <code>RVM$par2</code>. The object
is augmented by the following information about the fit:</p>
<dl><dt>se, se2</dt>
<dd><p>standard errors for the parameter estimates; note that these
are only approximate since they do not
account for the sequential nature of the estimation,</p></dd>

<dt>nobs</dt>
<dd><p>number of observations,</p></dd>

<dt>logLik, pair.logLik</dt>
<dd><p>log likelihood (overall and pairwise)</p></dd>

<dt>AIC, pair.AIC</dt>
<dd><p>Aikaike's Informaton Criterion (overall and pairwise),</p></dd>

<dt>BIC, pair.BIC</dt>
<dd><p>Bayesian's Informaton Criterion (overall and pairwise),</p></dd>

<dt>emptau</dt>
<dd><p>matrix of empirical values of Kendall's tau,</p></dd>

<dt>p.value.indeptest</dt>
<dd><p>matrix of p-values of the independence test.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>R-vine trees are selected using maximum spanning trees w.r.t. some edge
weights. The most commonly used edge weight is the absolute value of the
empirical Kendall's tau, say \(\hat{\tau}_{ij}\). Then, the following
optimization problem is solved for each tree:
$$\max \sum_{\mathrm{edges }\; e_{ij} \in \; \mathrm{ in \; spanning \; tree}} |\hat{\tau}_{ij}|, $$
where a spanning tree is a tree on all nodes. The
setting of the first tree selection step is always a complete graph. For
subsequent trees, the setting depends on the R-vine construction principles,
in particular on the proximity condition.</p>
<p>Some commonly used edge weights are implemented:</p><table class="table table"><tr><td><code>"tau"</code></td><td>absolute value of empirical Kendall's tau.</td></tr><tr><td><code>"rho"</code></td><td>absolute value of empirical Spearman's rho.</td></tr><tr><td><code>"AIC"</code></td><td>Akaike information (multiplied by -1).</td></tr><tr><td><code>"BIC"</code></td><td>Bayesian information criterion (multiplied by -1).</td></tr><tr><td><code>"cAIC"</code></td><td>corrected Akaike information criterion (multiplied by -1).</td></tr></table><p>If the data contain NAs, the edge weights in <code>"tau"</code> and <code>"rho"</code> are
multiplied by the square root of the proportion of complete observations. This
penalizes pairs where less observations are used. <br></p>
<p>The criteria <code>"AIC"</code>, <code>"BIC"</code>, and <code>"cAIC"</code> require estimation and
model selection for all possible pairs. This is computationally expensive and
much slower than <code>"tau"</code> or <code>"rho"</code>.
The user can also specify a custom function to calculate the edge weights.
The function has to be of type <code>function(u1, u2, weights) ...</code> and must
return a numeric value. The weights argument must exist, but does not has to
be used. For example, <code>"tau"</code> (without using weights) can be implemented
as follows:<br><code>function(u1, u2, weights)</code> <br><code>abs(cor(u1, u2, method = "kendall", use = "complete.obs"))</code></p>
<p>The root nodes of C-vine trees are determined similarly by identifying the
node with strongest dependencies to all other nodes. That is we take the
node with maximum column sum in the empirical Kendall's tau matrix.</p>
<p>Note that a possible way to determine the order of the nodes in the D-vine
is to identify a shortest Hamiltonian path in terms of weights
\(1-|\hat{\tau_{ij}|}\). This can be established for example using the package
TSP. Example code is shown below.</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>For a comprehensive summary of the vine copula model, use
<code>summary(object)</code>; to see all its contents, use <code>str(object)</code>.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Brechmann, E. C., C. Czado, and K. Aas (2012). Truncated regular
vines in high dimensions with applications to financial data. Canadian
Journal of Statistics 40 (1), 68-85.</p>
<p>Dissmann, J. F., E. C. Brechmann, C. Czado, and D. Kurowicka (2013).
Selecting and estimating regular vine copulae and application to financial
returns. Computational Statistics &amp; Data Analysis, 59 (1), 52-69.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="RVineMatrix.html">RVineMatrix()</a></code>,
<code><a href="BiCop.html">BiCop()</a></code>,
<code><a href="RVineCopSelect.html">RVineCopSelect()</a></code>,
<code><a href="plot.RVineMatrix.html">plot.RVineMatrix()</a></code>,
<code><a href="plot.RVineMatrix.html">contour.RVineMatrix()</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Jeffrey Dissmann, Eike Brechmann, Ulf Schepsmeier, Thomas Nagler</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"></span>
<span class="r-in"><span class="co"># load data set</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">daxreturns</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># select the R-vine structure, families and parameters</span></span>
<span class="r-in"><span class="co"># using only the first 4 variables and the first 250 observations</span></span>
<span class="r-in"><span class="co"># we allow for the copula families: Gauss, t, Clayton, Gumbel, Frank and Joe</span></span>
<span class="r-in"><span class="va">daxreturns</span> <span class="op">&lt;-</span> <span class="va">daxreturns</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">250</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></span>
<span class="r-in"><span class="va">RVM</span> <span class="op">&lt;-</span> <span class="fu">RVineStructureSelect</span><span class="op">(</span><span class="va">daxreturns</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span>, progress <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ALV.DE + BAYN.DE --&gt; ALV.DE,BAYN.DE ; BAS.DE</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> BAS.DE + BMW.DE --&gt; BAS.DE,BMW.DE ; ALV.DE</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> BAYN.DE + BMW.DE --&gt; BAYN.DE,BMW.DE ; ALV.DE,BAS.DE</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## see the object's content or a summary</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">RVM</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> List of 20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ Matrix     : num [1:4, 1:4] 3 4 1 2 0 2 4 1 0 0 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ family     : num [1:4, 1:4] 0 5 5 2 0 0 4 2 0 0 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ par        : num [1:4, 1:4] 0 1.183 1.111 0.648 0 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ par2       : num [1:4, 1:4] 0 0 0 2.48 0 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ names      : chr [1:4] "ALV.DE" "BAS.DE" "BAYN.DE" "BMW.DE"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ MaxMat     : num [1:4, 1:4] 3 2 2 2 0 2 1 1 0 0 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ CondDistr  :List of 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ direct  : logi [1:4, 1:4] FALSE TRUE TRUE TRUE FALSE FALSE ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ indirect: logi [1:4, 1:4] FALSE FALSE FALSE FALSE FALSE TRUE ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ type       : chr "D-vine"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ tau        : num [1:4, 1:4] 0 0.129 0.122 0.449 0 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ taildep    :List of 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ upper: num [1:4, 1:4] 0 0 0 0.444 0 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ lower: num [1:4, 1:4] 0 0 0 0.444 0 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ beta       : num [1:4, 1:4] 0 0.146 0.137 NA 0 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ call       : language RVineStructureSelect(data = daxreturns, familyset = c(1:6), progress = TRUE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ nobs       : int 250</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ logLik     : num 188</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ pair.logLik: num [1:4, 1:4] 0 3.84 3.76 71.62 0 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ AIC        : num -360</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ pair.AIC   : num [1:4, 1:4] 0 -5.67 -5.52 -139.24 0 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ BIC        : num -332</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ pair.BIC   : num [1:4, 1:4] 0 -2.15 -2 -132.2 0 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ emptau     : num [1:4, 1:4] 0 0.126 0.112 0.432 0 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - attr(*, "class")= chr "RVineMatrix"</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">RVM</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tree     edge | family  cop   par  par2 |  tau   utd   ltd </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------------- </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1      2,3 |      2    t  0.65  2.48 | 0.45  0.44  0.44</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           1,2 |      2    t  0.61  3.55 | 0.42  0.35  0.35</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           4,1 |     14   SG  1.62  0.00 | 0.38     -  0.46</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    2    1,3;2 |      5    F  1.11  0.00 | 0.12     -     -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         4,2;1 |      4    G  1.22  0.00 | 0.18  0.24     -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    3  4,3;1,2 |      5    F  1.18  0.00 | 0.13     -     -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> type: D-vine    logLik: 187.94    AIC: -359.87    BIC: -331.7    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 &lt;-&gt; ALV.DE,   2 &lt;-&gt; BAS.DE,   3 &lt;-&gt; BAYN.DE,   4 &lt;-&gt; BMW.DE</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## inspect the fitted model using plots</span></span>
<span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">RVM</span><span class="op">)</span>  <span class="co"># tree structure</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/contour.html" class="external-link">contour</a></span><span class="op">(</span><span class="va">RVM</span><span class="op">)</span>  <span class="co"># contour plots of all pair-copulas</span></span>
<span class="r-plt img"><img src="RVineStructureSelect-1.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## estimate a C-vine copula model with only Clayton, Gumbel and Frank copulas</span></span>
<span class="r-in"><span class="va">CVM</span> <span class="op">&lt;-</span> <span class="fu">RVineStructureSelect</span><span class="op">(</span><span class="va">daxreturns</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">5</span><span class="op">)</span>, <span class="st">"CVine"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## determine the order of the nodes in a D-vine using the package TSP</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mhahsler/TSP" class="external-link">TSP</a></span><span class="op">)</span></span>
<span class="r-in"><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">daxreturns</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span class="r-in"><span class="va">M</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu"><a href="TauMatrix.html">TauMatrix</a></span><span class="op">(</span><span class="va">daxreturns</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">hamilton</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TSP/man/insert_dummy.html" class="external-link">insert_dummy</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/TSP/man/TSP.html" class="external-link">TSP</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span>, label <span class="op">=</span> <span class="st">"cut"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">sol</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TSP/man/solve_TSP.html" class="external-link">solve_TSP</a></span><span class="op">(</span><span class="va">hamilton</span>, method <span class="op">=</span> <span class="st">"repetitive_nn"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">order</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TSP/man/cut_tour.html" class="external-link">cut_tour</a></span><span class="op">(</span><span class="va">sol</span>, <span class="st">"cut"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">DVM</span> <span class="op">&lt;-</span> <span class="fu"><a href="D2RVine.html">D2RVine</a></span><span class="op">(</span><span class="va">order</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">d</span><span class="op">*</span><span class="op">(</span><span class="va">d</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>, par <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">d</span><span class="op">*</span><span class="op">(</span><span class="va">d</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="RVineCopSelect.html">RVineCopSelect</a></span><span class="op">(</span><span class="va">daxreturns</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span>, <span class="va">DVM</span><span class="op">$</span><span class="va">Matrix</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> D-vine copula with the following pair-copulas:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Tree 1:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2,3  t (par = 0.65, par2 = 2.48, tau = 0.45) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1,2  t (par = 0.61, par2 = 3.55, tau = 0.42) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4,1  Survival Gumbel (par = 1.62, tau = 0.38) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Tree 2:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1,3;2  Frank (par = 1.11, tau = 0.12) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4,2;1  Gumbel (par = 1.22, tau = 0.18) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Tree 3:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4,3;1,2  Frank (par = 1.18, tau = 0.13) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 &lt;-&gt; ALV.DE,   2 &lt;-&gt; BAS.DE,   3 &lt;-&gt; BAYN.DE,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 &lt;-&gt; BMW.DE</span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Thomas Nagler, Ulf Schepsmeier, Jakob Stoeber, Eike Christian Brechmann, Benedikt Graeler, Tobias Erhardt.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

