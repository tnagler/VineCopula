<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Selection and Maximum Likelihood Estimation of Bivariate Copula Families — BiCopSelect • VineCopula</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Selection and Maximum Likelihood Estimation of Bivariate Copula Families — BiCopSelect" />

<meta property="og:description" content="This function selects an appropriate bivariate copula family for given
bivariate copula data using one of a range of methods. The corresponding
parameter estimates are obtained by maximum likelihood estimation." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">VineCopula</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.1.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/tnagler/VineCopula">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Selection and Maximum Likelihood Estimation of Bivariate Copula Families</h1>
    <small class="dont-index">Source: <a href='https://github.com/tnagler/VineCopula/blob/master/R/BiCopSelect.R'><code>R/BiCopSelect.R</code></a></small>
    <div class="hidden name"><code>BiCopSelect.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>This function selects an appropriate bivariate copula family for given
bivariate copula data using one of a range of methods. The corresponding
parameter estimates are obtained by maximum likelihood estimation.</p>
    
    </div>

    <pre class="usage"><span class='fu'>BiCopSelect</span>(<span class='no'>u1</span>, <span class='no'>u2</span>, <span class='kw'>familyset</span> <span class='kw'>=</span> <span class='fl'>NA</span>, <span class='kw'>selectioncrit</span> <span class='kw'>=</span> <span class='st'>"AIC"</span>,
  <span class='kw'>indeptest</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>level</span> <span class='kw'>=</span> <span class='fl'>0.05</span>, <span class='kw'>weights</span> <span class='kw'>=</span> <span class='fl'>NA</span>, <span class='kw'>rotations</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>se</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>presel</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"mle"</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>u1, u2</th>
      <td><p>Data vectors of equal length with values in [0,1].</p></td>
    </tr>
    <tr>
      <th>familyset</th>
      <td><p>Vector of bivariate copula families to select from.
The vector has to include at least one bivariate copula
family that allows for positive and one that allows for negative dependence.
If <code>familyset = NA</code> (default), selection among all possible families is
performed. If a vector of negative numbers is provided, selection among all
but <code><a href='https://www.rdocumentation.org/packages/base/topics/MathFun'>abs(familyset)</a></code> families is performed. Coding of bivariate copula
families: <br />
<code>0</code> = independence copula <br />
<code>1</code> = Gaussian copula <br />
<code>2</code> = Student t copula (t-copula) <br />
<code>3</code> = Clayton copula <br />
<code>4</code> = Gumbel copula <br />
<code>5</code> = Frank copula <br />
<code>6</code> = Joe copula <br />
<code>7</code> = BB1 copula <br />
<code>8</code> = BB6 copula <br />
<code>9</code> = BB7 copula <br />
<code>10</code> = BB8 copula <br />
<code>13</code> = rotated Clayton copula (180 degrees; ``survival Clayton'') <br />
<code>14</code> = rotated Gumbel copula (180 degrees; ``survival Gumbel'') <br />
<code>16</code> = rotated Joe copula (180 degrees; ``survival Joe'') <br />
<code>17</code> = rotated BB1 copula (180 degrees; ``survival BB1'')<br />
<code>18</code> = rotated BB6 copula (180 degrees; ``survival BB6'')<br />
<code>19</code> = rotated BB7 copula (180 degrees; ``survival BB7'')<br />
<code>20</code> = rotated BB8 copula (180 degrees; ``survival BB8'')<br />
<code>23</code> = rotated Clayton copula (90 degrees) <br />
<code>24</code> = rotated Gumbel copula (90 degrees) <br />
<code>26</code> = rotated Joe copula (90 degrees) <br />
<code>27</code> = rotated BB1 copula (90 degrees) <br />
<code>28</code> = rotated BB6 copula (90 degrees) <br />
<code>29</code> = rotated BB7 copula (90 degrees) <br />
<code>30</code> = rotated BB8 copula (90 degrees) <br />
<code>33</code> = rotated Clayton copula (270 degrees) <br />
<code>34</code> = rotated Gumbel copula (270 degrees) <br />
<code>36</code> = rotated Joe copula (270 degrees) <br />
<code>37</code> = rotated BB1 copula (270 degrees) <br />
<code>38</code> = rotated BB6 copula (270 degrees) <br />
<code>39</code> = rotated BB7 copula (270 degrees) <br />
<code>40</code> = rotated BB8 copula (270 degrees) <br />
<code>104</code> = Tawn type 1 copula <br />
<code>114</code> = rotated Tawn type 1 copula (180 degrees) <br />
<code>124</code> = rotated Tawn type 1 copula (90 degrees) <br />
<code>134</code> = rotated Tawn type 1 copula (270 degrees) <br />
<code>204</code> = Tawn type 2 copula <br />
<code>214</code> = rotated Tawn type 2 copula (180 degrees) <br />
<code>224</code> = rotated Tawn type 2 copula (90 degrees) <br />
<code>234</code> = rotated Tawn type 2 copula (270 degrees) <br /></p></td>
    </tr>
    <tr>
      <th>selectioncrit</th>
      <td><p>Character indicating the criterion for bivariate copula
selection. Possible choices: <code>selectioncrit = "AIC"</code> (default),
<code>"BIC"</code>, or <code>"logLik"</code>.</p></td>
    </tr>
    <tr>
      <th>indeptest</th>
      <td><p>Logical; whether a hypothesis test for the independence of
<code>u1</code> and <code>u2</code> is performed before bivariate copula selection
(default: <code>indeptest = FALSE</code>; see <code><a href='BiCopIndTest.html'>BiCopIndTest</a></code>).  The
independence copula is chosen if the null hypothesis of independence cannot
be rejected.</p></td>
    </tr>
    <tr>
      <th>level</th>
      <td><p>Numeric; significance level of the independence test (default:
<code>level = 0.05</code>).</p></td>
    </tr>
    <tr>
      <th>weights</th>
      <td><p>Numerical; weights for each observation (optional).</p></td>
    </tr>
    <tr>
      <th>rotations</th>
      <td><p>If <code>TRUE</code>, all rotations of the families in
<code>familyset</code> are included (or subtracted).</p></td>
    </tr>
    <tr>
      <th>se</th>
      <td><p>Logical; whether standard error(s) of parameter estimates is/are
estimated (default: <code>se = FALSE</code>).</p></td>
    </tr>
    <tr>
      <th>presel</th>
      <td><p>Logical; whether to exclude families before fitting based on
symmetry properties of the data. Makes the selection about 30% faster
(on average), but may yield slightly worse results in few special cases.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>indicates the estimation method: either maximum
likelihood estimation (<code>method = "mle"</code>; default) or inversion of
Kendall's tau (<code>method = "itau"</code>). For <code>method = "itau"</code> only
one parameter families and the Student t copula can be used (<code>family =
1,2,3,4,5,6,13,14,16,23,24,26,33,34</code> or <code>36</code>). For the t-copula,
<code>par2</code> is found by a crude profile likelihood optimization over the
interval (2, 10].</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class <code><a href='BiCop.html'>BiCop</a></code>, augmented with the following
entries:</p>
<dt>se, se2</dt><dd><p>standard errors for the parameter estimates (if
<code>se = TRUE</code>,</p></dd>
<dt>nobs</dt><dd><p>number of observations,</p></dd>
<dt>logLik</dt><dd><p>log likelihood</p></dd>
<dt>AIC</dt><dd><p>Aikaike's Informaton Criterion,</p></dd>
<dt>BIC</dt><dd><p>Bayesian's Informaton Criterion,</p></dd>
<dt>emptau</dt><dd><p>empirical value of Kendall's tau,</p></dd>
<dt>p.value.indeptest</dt><dd><p>p-value of the independence test.</p></dd>

    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Copulas can be selected according to the Akaike and Bayesian Information
Criteria (AIC and BIC, respectively). First all available copulas are fitted
using maximum likelihood estimation. Then the criteria are computed for all
available copula families (e.g., if <code>u1</code> and <code>u2</code> are negatively
dependent, Clayton, Gumbel, Joe, BB1, BB6, BB7 and BB8 and their survival
copulas are not considered) and the family with the minimum value is chosen.
For observations \(u_{i,j},\ i=1,...,N,\ j=1,2,\) the AIC of a bivariate copula family \(c\) with parameter(s)
\(\boldsymbol{\theta}\) is defined as $$AIC := -2 \sum_{i=1}^N
\ln[c(u_{i,1},u_{i,2}|\boldsymbol{\theta})] + 2k, $$ where \(k=1\) for one parameter
copulas and \(k=2\) for the two parameter t-, BB1, BB6, BB7 and BB8
copulas. Similarly, the BIC is given by $$BIC := -2 \sum_{i=1}^N
\ln[c(u_{i,1},u_{i,2}|\boldsymbol{\theta})] + \ln(N)k. $$ Evidently, if the BIC
is chosen, the penalty for two parameter families is stronger than when
using the AIC.</p>
<p>Additionally a test for independence can be performed beforehand.</p>
    
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>For a comprehensive summary of the fitted model, use
<code><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary(object)</a></code>; to see all its contents, use <code><a href='https://www.rdocumentation.org/packages/utils/topics/str'>str(object)</a></code>.</p>
<p>The parameters of the Student t and BB copulas are restricted (see
defaults in <code><a href='BiCopEst.html'>BiCopEst</a></code> to avoid being to close to their limiting
cases.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Akaike, H. (1973). Information theory and an extension of the
maximum likelihood principle. In B. N. Petrov and F. Csaki (Eds.),
Proceedings of the Second International Symposium on Information Theory
Budapest, Akademiai Kiado, pp. 267-281.</p>
<p>Brechmann, E. C. (2010). Truncated and simplified regular vines and their
applications. Diploma thesis, Technische Universitaet Muenchen.<br />
<a href='http://mediatum.ub.tum.de/?id=1079285'>http://mediatum.ub.tum.de/?id=1079285</a>.</p>
<p>Manner, H. (2007). Estimation and model selection of copulas with an
application to exchange rates. METEOR research memorandum 07/056, Maastricht
University.</p>
<p>Schwarz, G. E. (1978). Estimating the dimension of a model. Annals of
Statistics 6 (2), 461-464.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='BiCop.html'>BiCop</a></code>,
<code><a href='BiCopEst.html'>BiCopEst</a></code>,
<code><a href='RVineStructureSelect.html'>RVineStructureSelect</a></code>,
<code><a href='RVineCopSelect.html'>RVineCopSelect</a></code>,
<code><a href='BiCopIndTest.html'>BiCopIndTest</a></code>,</p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>## Example 1: Gaussian copula with large dependence parameter</span>
<span class='no'>par</span> <span class='kw'>&lt;-</span> <span class='fl'>0.7</span>
<span class='no'>fam</span> <span class='kw'>&lt;-</span> <span class='fl'>1</span>
<span class='no'>dat1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='BiCopSim.html'>BiCopSim</a></span>(<span class='fl'>500</span>, <span class='no'>fam</span>, <span class='no'>par</span>)
<span class='co'># select the bivariate copula family and estimate the parameter(s)</span>
<span class='no'>cop1</span> <span class='kw'>&lt;-</span> <span class='fu'>BiCopSelect</span>(<span class='no'>dat1</span>[, <span class='fl'>1</span>], <span class='no'>dat1</span>[, <span class='fl'>2</span>], <span class='kw'>familyset</span> <span class='kw'>=</span> <span class='fl'>1</span>:<span class='fl'>10</span>,
                    <span class='kw'>indeptest</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>level</span> <span class='kw'>=</span> <span class='fl'>0.05</span>)
<span class='no'>cop1</span>  <span class='co'># short overview</span></div><div class='output co'>#&gt; Bivariate copula: Gaussian (par = 0.68, tau = 0.47) </div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>cop1</span>)  <span class='co'># comprehensive overview</span></div><div class='output co'>#&gt; Family
#&gt; ------ 
#&gt; No:    1
#&gt; Name:  Gaussian
#&gt; 
#&gt; Parameter(s)
#&gt; ------------
#&gt; par:  0.68
#&gt; 
#&gt; Dependence measures
#&gt; -------------------
#&gt; Kendall's tau:    0.47 (empirical = 0.46, p value &lt; 0.01)
#&gt; Upper TD:         0 
#&gt; Lower TD:         0 
#&gt; 
#&gt; Fit statistics
#&gt; --------------
#&gt; logLik:  140.06 
#&gt; AIC:    -278.11 
#&gt; BIC:    -273.9 
#&gt; </div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/str'>str</a></span>(<span class='no'>cop1</span>)  <span class='co'># see all contents of the object</span></div><div class='output co'>#&gt; List of 15
#&gt;  $ family           : num 1
#&gt;  $ par              : num 0.675
#&gt;  $ par2             : num 0
#&gt;  $ npars            : num 1
#&gt;  $ familyname       : chr "Gaussian"
#&gt;  $ tau              : num 0.472
#&gt;  $ beta             : num 0.472
#&gt;  $ taildep          :List of 2
#&gt;   ..$ lower: num 0
#&gt;   ..$ upper: num 0
#&gt;  $ call             : language BiCopSelect(u1 = dat1[, 1], u2 = dat1[, 2], familyset = 1:10, indeptest = FALSE,      level = 0.05)
#&gt;  $ nobs             : int 500
#&gt;  $ logLik           : num 140
#&gt;  $ AIC              : num -278
#&gt;  $ BIC              : num -274
#&gt;  $ emptau           : num 0.461
#&gt;  $ p.value.indeptest: num 0
#&gt;  - attr(*, "class")= chr "BiCop"</div><div class='input'>
<span class='co'>## Example 2: Gaussian copula with small dependence parameter</span>
<span class='no'>par</span> <span class='kw'>&lt;-</span> <span class='fl'>0.01</span>
<span class='no'>fam</span> <span class='kw'>&lt;-</span> <span class='fl'>1</span>
<span class='no'>dat2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='BiCopSim.html'>BiCopSim</a></span>(<span class='fl'>500</span>, <span class='no'>fam</span>, <span class='no'>par</span>)
<span class='co'># select the bivariate copula family and estimate the parameter(s)</span>
<span class='no'>cop2</span> <span class='kw'>&lt;-</span> <span class='fu'>BiCopSelect</span>(<span class='no'>dat2</span>[, <span class='fl'>1</span>], <span class='no'>dat2</span>[, <span class='fl'>2</span>], <span class='kw'>familyset</span> <span class='kw'>=</span> <span class='fl'>0</span>:<span class='fl'>10</span>,
                    <span class='kw'>indeptest</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>level</span> <span class='kw'>=</span> <span class='fl'>0.05</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>cop2</span>)</div><div class='output co'>#&gt; Family
#&gt; ------ 
#&gt; No:    5
#&gt; Name:  Frank
#&gt; 
#&gt; Parameter(s)
#&gt; ------------
#&gt; par:  -0.58
#&gt; 
#&gt; Dependence measures
#&gt; -------------------
#&gt; Kendall's tau:    -0.06 (empirical = -0.07, p value = 0.02)
#&gt; Upper TD:         0 
#&gt; Lower TD:         0 
#&gt; 
#&gt; Fit statistics
#&gt; --------------
#&gt; logLik:  2.51 
#&gt; AIC:    -3.02 
#&gt; BIC:    1.19 
#&gt; </div><div class='input'>
<span class='co'>## Example 3: empirical data</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='no'>daxreturns</span>)
<span class='no'>cop3</span> <span class='kw'>&lt;-</span> <span class='fu'>BiCopSelect</span>(<span class='no'>daxreturns</span>[, <span class='fl'>1</span>], <span class='no'>daxreturns</span>[, <span class='fl'>4</span>], <span class='kw'>familyset</span> <span class='kw'>=</span> <span class='fl'>0</span>:<span class='fl'>10</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>cop3</span>)</div><div class='output co'>#&gt; Family
#&gt; ------ 
#&gt; No:    14
#&gt; Name:  Survival Gumbel
#&gt; 
#&gt; Parameter(s)
#&gt; ------------
#&gt; par:  1.61
#&gt; 
#&gt; Dependence measures
#&gt; -------------------
#&gt; Kendall's tau:    0.38 (empirical = 0.4, p value &lt; 0.01)
#&gt; Upper TD:         0 
#&gt; Lower TD:         0.46 
#&gt; 
#&gt; Fit statistics
#&gt; --------------
#&gt; logLik:  241.84 
#&gt; AIC:    -481.68 
#&gt; BIC:    -476.62 
#&gt; </div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#note">Note</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Eike Brechmann, Jeffrey Dissmann, Thomas Nagler</p>
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Ulf Schepsmeier, Jakob Stoeber, Eike Christian Brechmann, Benedikt Graeler, Thomas Nagler, Tobias Erhardt.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

