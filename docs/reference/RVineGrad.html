<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Gradient of the Log-Likelihood of an R-Vine Copula Model — RVineGrad • VineCopula</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Gradient of the Log-Likelihood of an R-Vine Copula Model — RVineGrad"><meta property="og:description" content="This function calculates the gradient of the log-likelihood of a
d-dimensional R-vine copula model with respect to the copula parameter and
evaluates it on a given copula data set."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">VineCopula</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.5.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/tnagler/VineCopula/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Gradient of the Log-Likelihood of an R-Vine Copula Model</h1>
    <small class="dont-index">Source: <a href="https://github.com/tnagler/VineCopula/blob/HEAD/R/RVineGrad.R" class="external-link"><code>R/RVineGrad.R</code></a></small>
    <div class="hidden name"><code>RVineGrad.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function calculates the gradient of the log-likelihood of a
d-dimensional R-vine copula model with respect to the copula parameter and
evaluates it on a given copula data set.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">RVineGrad</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">RVM</span>,</span>
<span>  par <span class="op">=</span> <span class="va">RVM</span><span class="op">$</span><span class="va">par</span>,</span>
<span>  par2 <span class="op">=</span> <span class="va">RVM</span><span class="op">$</span><span class="va">par2</span>,</span>
<span>  start.V <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  posParams <span class="op">=</span> <span class="op">(</span><span class="va">RVM</span><span class="op">$</span><span class="va">family</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>data</dt>
<dd><p>An N x d data matrix (with uniform margins).</p></dd>


<dt>RVM</dt>
<dd><p>An <code><a href="RVineMatrix.html">RVineMatrix()</a></code> object including the structure and
the pair-copula families and parameters. <br>
Only the following copula
families are allowed in <code>RVM$family</code> <br><code>0</code> = independence copula <br><code>1</code> = Gaussian copula <br><code>2</code> = Student t copula (t-copula)<br><code>3</code> = Clayton copula <br><code>4</code> = Gumbel copula <br><code>5</code> = Frank copula <br><code>6</code> = Joe copula <br><code>13</code> = rotated Clayton copula (180 degrees; <code>survival Clayton'') \cr `14` = rotated Gumbel copula (180 degrees; </code>survival Gumbel'') <br><code>16</code> = rotated Joe copula (180 degrees; ``survival Joe'') <br><code>23</code> = rotated Clayton copula (90 degrees) <br>
`24` = rotated Gumbel copula (90 degrees) <br>
`26` = rotated Joe copula (90 degrees) <br>
`33` = rotated Clayton copula (270 degrees) <br>
`34` = rotated Gumbel copula (270 degrees) <br>
`36` = rotated Joe copula (270 degrees) <br></p></dd>


<dt>par</dt>
<dd><p>A d x d matrix with the pair-copula parameters (optional;
default: <code>par = RVM$par</code>).</p></dd>


<dt>par2</dt>
<dd><p>A d x d matrix with the second parameters of pair-copula
families with two parameters (optional; default: <code>par2 = RVM$par2</code>).</p></dd>


<dt>start.V</dt>
<dd><p>Transformations (h-functions and log-likelihoods of each
pair-copula) of previous calculations (see output; default: <code>start.V = NA</code>).</p></dd>


<dt>posParams</dt>
<dd><p>A d x d matrix indicating which copula has to be considered
in the gradient (default: <code>posParams = (RVM$family &gt; 0)</code>).</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>gradient The calculated gradient of the log-likelihood value
of the R-vine copula model. (three matrices: <code>direct</code>, <code>indirect</code></p>


<p>and <code>value</code>).</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The ordering of the gradient is due to the ordering of the R-vine matrix.
The gradient starts at the lower right corner of the R-vine matrix and goes
column by column to the left and up, i.e. the first entry of the gradient is
the last entry of the second last column of the <code>par</code>-matrix followed
by the last entry of the third last column and the second last entry of this
column. If there is a copula family with two parameters, i.e. the t-copula,
the derivative with respect to the second parameter is at the end of the
gradient vector in order of their occurrence.</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>The gradient for R-vine copula models with two parameter Archimedean
copulas, i.e. BB1, BB6, BB7, BB8 and their rotated versions can not yet be calculated.
The derivatives of these bivariate copulas are more complicated.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Dissmann, J. F., E. C. Brechmann, C. Czado, and D. Kurowicka
(2013). Selecting and estimating regular vine copulae and application to
financial returns. Computational Statistics &amp; Data Analysis, 59 (1), 52-69.</p>
<p>Schepsmeier, U. and J. Stoeber (2014)
Derivatives and Fisher information of bivariate copulas.
Statistical Papers, 55(2), 525-542.
online first: <a href="https://link.springer.com/article/10.1007/s00362-013-0498-x" class="external-link">https://link.springer.com/article/10.1007/s00362-013-0498-x</a>.</p>
<p>Web supplement: Derivatives and Fisher Information of bivariate copulas.
<a href="https://mediatum.ub.tum.de/node?id=1119201" class="external-link">https://mediatum.ub.tum.de/node?id=1119201</a></p>
<p>Stoeber, J. and U. Schepsmeier (2013). Estimating standard errors in regular
vine copula models. Computational Statistics, 28 (6), 2679-2707
<a href="https://link.springer.com/article/10.1007/s00180-013-0423-8#" class="external-link">https://link.springer.com/article/10.1007/s00180-013-0423-8#</a>.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="BiCopDeriv.html">BiCopDeriv()</a></code>,
<code><a href="BiCopDeriv2.html">BiCopDeriv2()</a></code>,
<code><a href="BiCopHfuncDeriv.html">BiCopHfuncDeriv()</a></code>,
<code><a href="BiCopHfuncDeriv2.html">BiCopHfuncDeriv2()</a></code>, <br><code><a href="RVineMatrix.html">RVineMatrix()</a></code>,
<code><a href="RVineMLE.html">RVineMLE()</a></code>,
<code><a href="RVineHessian.html">RVineHessian()</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Ulf Schepsmeier, Jakob Stoeber</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># define 5-dimensional R-vine tree structure matrix</span></span></span>
<span class="r-in"><span><span class="va">Matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">4</span>,</span></span>
<span class="r-in"><span>            <span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">1</span>,</span></span>
<span class="r-in"><span>            <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">1</span>,</span></span>
<span class="r-in"><span>            <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">4</span>, <span class="fl">1</span>,</span></span>
<span class="r-in"><span>            <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">Matrix</span>, <span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># define R-vine pair-copula family matrix</span></span></span>
<span class="r-in"><span><span class="va">family</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">4</span>,</span></span>
<span class="r-in"><span>            <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">1</span>,</span></span>
<span class="r-in"><span>            <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">4</span>, <span class="fl">1</span>,</span></span>
<span class="r-in"><span>            <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">3</span>,</span></span>
<span class="r-in"><span>            <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">family</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">family</span>, <span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># define R-vine pair-copula parameter matrix</span></span></span>
<span class="r-in"><span><span class="va">par</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.2</span>, <span class="fl">0.9</span>, <span class="fl">1.5</span>, <span class="fl">3.9</span>,</span></span>
<span class="r-in"><span>         <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1.1</span>, <span class="fl">1.6</span>, <span class="fl">0.9</span>,</span></span>
<span class="r-in"><span>         <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1.9</span>, <span class="fl">0.5</span>,</span></span>
<span class="r-in"><span>         <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">4.8</span>,</span></span>
<span class="r-in"><span>         <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">par</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">par</span>, <span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># define second R-vine pair-copula parameter matrix</span></span></span>
<span class="r-in"><span><span class="va">par2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># define RVineMatrix object</span></span></span>
<span class="r-in"><span><span class="va">RVM</span> <span class="op">&lt;-</span> <span class="fu"><a href="RVineMatrix.html">RVineMatrix</a></span><span class="op">(</span>Matrix <span class="op">=</span> <span class="va">Matrix</span>, family <span class="op">=</span> <span class="va">family</span>,</span></span>
<span class="r-in"><span>                   par <span class="op">=</span> <span class="va">par</span>, par2 <span class="op">=</span> <span class="va">par2</span>,</span></span>
<span class="r-in"><span>                   names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"V1"</span>, <span class="st">"V2"</span>, <span class="st">"V3"</span>, <span class="st">"V4"</span>, <span class="st">"V5"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># simulate a sample of size 300 from the R-vine copula model</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">simdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="RVineSim.html">RVineSim</a></span><span class="op">(</span><span class="fl">300</span>, <span class="va">RVM</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># compute the gradient of the first row of the data</span></span></span>
<span class="r-in"><span><span class="va">out2</span> <span class="op">&lt;-</span> <span class="fu">RVineGrad</span><span class="op">(</span><span class="va">simdata</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span>, <span class="va">RVM</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">out2</span><span class="op">$</span><span class="va">gradient</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]  1.5956128 -0.2851612 -1.7426652 -0.2077662 -0.1693743  0.5534283</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7] -5.0518528 -0.4287275  3.2388926 -0.3446294</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Thomas Nagler, Ulf Schepsmeier, Jakob Stoeber, Eike Christian Brechmann, Benedikt Graeler, Tobias Erhardt.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer></div>

  


  

  </body></html>

