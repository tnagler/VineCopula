<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Goodness-of-Fit Test for Bivariate Copulas — BiCopGofTest • VineCopula</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Goodness-of-Fit Test for Bivariate Copulas — BiCopGofTest" />

<meta property="og:description" content="This function performs a goodness-of-fit test for bivariate copulas, either
based on White's information matrix equality (White, 1982) as introduced by
Huang and Prokhorov (2011) or based on Kendall's process
(Wang and Wells, 2000; Genest et al., 2006). It computes the test statistics
and p-values." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">VineCopula</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.1.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/tnagler/VineCopula">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Goodness-of-Fit Test for Bivariate Copulas</h1>
    <small class="dont-index">Source: <a href='https://github.com/tnagler/VineCopula/blob/master/R/BiCopGofTest.R'><code>R/BiCopGofTest.R</code></a></small>
    <div class="hidden name"><code>BiCopGofTest.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>This function performs a goodness-of-fit test for bivariate copulas, either
based on White's information matrix equality (White, 1982) as introduced by
Huang and Prokhorov (2011) or based on Kendall's process
(Wang and Wells, 2000; Genest et al., 2006). It computes the test statistics
and p-values.</p>
    
    </div>

    <pre class="usage"><span class='fu'>BiCopGofTest</span>(<span class='no'>u1</span>, <span class='no'>u2</span>, <span class='no'>family</span>, <span class='kw'>par</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>par2</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"white"</span>,
  <span class='kw'>max.df</span> <span class='kw'>=</span> <span class='fl'>30</span>, <span class='kw'>B</span> <span class='kw'>=</span> <span class='fl'>100</span>, <span class='kw'>obj</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>u1, u2</th>
      <td><p>Numeric vectors of equal length with values in [0,1].</p></td>
    </tr>
    <tr>
      <th>family</th>
      <td><p>An integer defining the bivariate copula family: <br />
<code>0</code> = independence copula <br />
<code>1</code> = Gaussian copula <br />
<code>2</code> = Student t copula (t-copula) (only for <code>method = "white"</code>; see details)<br />
<code>3</code> = Clayton copula <br />
<code>4</code> = Gumbel copula <br />
<code>5</code> = Frank copula <br />
<code>6</code> = Joe copula <br />
<code>7</code> = BB1 copula (only for <code>method = "kendall"</code>)<br />
<code>8</code> = BB6 copula (only for <code>method = "kendall"</code>)<br />
<code>9</code> = BB7 copula (only for <code>method = "kendall"</code>)<br />
<code>10</code> = BB8 copula (only for <code>method ="kendall"</code>)<br />
<code>13</code> = rotated Clayton copula (180 degrees; ``survival Clayton'') <br />
<code>14</code> = rotated Gumbel copula (180 degrees; ``survival Gumbel'') <br />
<code>16</code> = rotated Joe copula (180 degrees; ``survival Joe'') <br />
<code>17</code> = rotated BB1 copula (180 degrees; ``survival BB1'';
only for <code>method = "kendall"</code>)<br />
<code>18</code> = rotated BB6 copula (180 degrees; ``survival BB6'';
only for <code>method = "kendall"</code>)<br />
<code>19</code> = rotated BB7 copula (180 degrees; ``survival BB7'';
only for <code>method = "kendall"</code>)<br />
<code>20</code> = rotated BB8 copula (180 degrees; ``survival BB8'';
only for <code>method = "kendall"</code>)<br />
<code>23</code> = rotated Clayton copula (90 degrees) <br />
<code>24</code> = rotated Gumbel copula (90 degrees) <br />
<code>26</code> = rotated Joe copula (90 degrees) <br />
<code>27</code> = rotated BB1 copula (90 degrees; only for <code>method = "kendall"</code>) <br />
<code>28</code> = rotated BB6 copula (90 degrees; only for <code>method = "kendall"</code>) <br />
<code>29</code> = rotated BB7 copula (90 degrees; only for <code>method = "kendall"</code>) <br />
<code>30</code> = rotated BB8 copula (90 degrees; only for <code>method = "kendall"</code>) <br />
<code>33</code> = rotated Clayton copula (270 degrees) <br />
<code>34</code> = rotated Gumbel copula (270 degrees) <br />
<code>36</code> = rotated Joe copula (270 degrees) <br />
<code>37</code> = rotated BB1 copula (270 degrees; only for <code>method = "kendall"</code>) <br />
<code>38</code> = rotated BB6 copula (270 degrees; only for <code>method = "kendall"</code>) <br />
<code>39</code> = rotated BB7 copula (270 degrees; only for <code>method = "kendall"</code>) <br />
<code>40</code> = rotated BB8 copula (270 degrees; only for <code>method = "kendall"</code>)</p></td>
    </tr>
    <tr>
      <th>par</th>
      <td><p>Copula parameter (optional).</p></td>
    </tr>
    <tr>
      <th>par2</th>
      <td><p>Second parameter for bivariate t-copula (optional); default:
<code>par2 = 0</code>.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>A string indicating the goodness-of-fit method:<br />
<code>"white"</code> = goodness-of-fit test based on White's information matrix
equality (default) <br />
<code>"kendall"</code> = goodness-of-fit test based on Kendall's process</p></td>
    </tr>
    <tr>
      <th>max.df</th>
      <td><p>Numeric; upper bound for the estimation of the degrees of
freedom parameter of the t-copula (default: <code>max.df = 30</code>).</p></td>
    </tr>
    <tr>
      <th>B</th>
      <td><p>Integer; number of bootstrap samples (default: <code>B = 100</code>).
For <code>B = 0</code> only the the test statistics are returned.<br /> WARNING: If
<code>B</code> is chosen too large, computations will take very long.</p></td>
    </tr>
    <tr>
      <th>obj</th>
      <td><p><code>BiCop</code> object containing the family and parameter
specification.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>For <code>method = "white"</code>:</p>
<dt>p.value</dt><dd><p>Asymptotic p-value.</p></dd>
<dt>statistic</dt><dd><p>The observed test statistic.</p></dd>
For method ="kendall"
<dt>p.value.CvM</dt><dd><p>Bootstrapped p-value of the goodness-of-fit
test using the Cramer-von Mises statistic (if <code>B &gt; 0</code>).</p></dd>
<dt>p.value.KS</dt><dd><p>Bootstrapped p-value of the goodness-of-fit test using the
Kolmogorov-Smirnov statistic (if <code>B &gt; 0</code>).</p></dd> <dt>statistic.CvM</dt><dd><p>The
observed Cramer-von Mises test statistic.</p></dd> <dt>statistic.KS</dt><dd><p>The observed
Kolmogorov-Smirnov test statistic.</p></dd>

    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>method = "white"</code>:<br /> This goodness-of fit test uses the information
matrix equality of White (1982) and was investigated by Huang and Prokhorov
(2011). The main contribution is that under correct model specification the
Fisher Information can be equivalently calculated as minus the expected
Hessian matrix or as the expected outer product of the score function. The
null hypothesis is $$ H_0: \boldsymbol{H}(\theta) +
\boldsymbol{C}(\theta) = 0 $$ against the alternative $$ H_0:
\boldsymbol{H}(\theta) + \boldsymbol{C}(\theta) \neq 0 , $$ where
\(\boldsymbol{H}(\theta)\) is the expected Hessian matrix and
\(\boldsymbol{C}(\theta)\) is the expected outer product of the score
function. For the calculation of the test statistic we use the consistent
maximum likelihood estimator \(\hat{\theta}\) and the sample counter parts
of \(\boldsymbol{H}(\theta)\) and \(\boldsymbol{C}(\theta)\). The
correction of the covariance-matrix in the test statistic for the
uncertainty in the margins is skipped. The implemented tests assumes that
where is no uncertainty in the margins. The correction can be found in Huang
and Prokhorov (2011). It involves two-dimensional integrals.<br /> WARNING: For
the t-copula the test may be unstable. The results for the t-copula
therefore have to be treated carefully.<br /> <br /> <code>method = "kendall"</code>:<br />
This copula goodness-of-fit test is based on Kendall's process as
proposed by Wang and Wells (2000). For computation of p-values, the
parametric bootstrap described by Genest et al. (2006) is used. For
rotated copulas the input arguments are transformed and the goodness-of-fit
procedure for the corresponding non-rotated copula is used.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Huang, W. and A. Prokhorov (2014). A goodness-of-fit test for copulas.
Econometric Reviews, 33 (7), 751-771.</p>
<p>Wang, W. and M. T. Wells (2000). Model selection and semiparametric
inference for bivariate failure-time data. Journal of the American
Statistical Association, 95 (449), 62-72.</p>
<p>Genest, C., Quessy, J. F., and Remillard, B. (2006). Goodness-of-fit
Procedures for Copula Models Based on the Probability Integral Transformation.
Scandinavian Journal of Statistics, 33(2), 337-366.
Luo J. (2011). Stepwise estimation of D-vines with arbitrary specified
copula pairs and EDA tools. Diploma thesis, Technische Universitaet
Muenchen.<br /> <a href='http://mediatum.ub.tum.de/?id=1079291'>http://mediatum.ub.tum.de/?id=1079291</a>.</p>
<p>White, H. (1982) Maximum likelihood estimation of misspecified models,
Econometrica, 50, 1-26.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='BiCopDeriv2.html'>BiCopDeriv2</a></code>, <code><a href='BiCopDeriv.html'>BiCopDeriv</a></code>,
<code><a href='BiCopIndTest.html'>BiCopIndTest</a></code>, <code><a href='BiCopVuongClarke.html'>BiCopVuongClarke</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
# simulate from a bivariate Clayton copula
</div><div class='input'><span class='no'>simdata</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='BiCopSim.html'>BiCopSim</a></span>(<span class='fl'>100</span>, <span class='fl'>3</span>, <span class='fl'>2</span>)
<span class='no'>u1</span> <span class='kw'>&lt;-</span> <span class='no'>simdata</span>[,<span class='fl'>1</span>]
<span class='no'>u2</span> <span class='kw'>&lt;-</span> <span class='no'>simdata</span>[,<span class='fl'>2</span>]

<span class='co'># perform White's goodness-of-fit test for the true copula</span>
<span class='fu'>BiCopGofTest</span>(<span class='no'>u1</span>, <span class='no'>u2</span>, <span class='kw'>family</span> <span class='kw'>=</span> <span class='fl'>3</span>)</div><div class='output co'>#&gt; $statistic
#&gt;           [,1]
#&gt; [1,] 0.1928871
#&gt; 
#&gt; $p.value
#&gt; [1] 0.66
#&gt; </div><div class='input'>
# perform White's goodness-of-fit test for the Frank copula
</div><div class='input'><span class='fu'>BiCopGofTest</span>(<span class='no'>u1</span>, <span class='no'>u2</span>, <span class='kw'>family</span> <span class='kw'>=</span> <span class='fl'>5</span>)</div><div class='output co'>#&gt; $statistic
#&gt;           [,1]
#&gt; [1,] 0.2883505
#&gt; 
#&gt; $p.value
#&gt; [1] 0.58
#&gt; </div><div class='input'>
<span class='co'># perform Kendall's goodness-of-fit test for the true copula</span>
<span class='fu'>BiCopGofTest</span>(<span class='no'>u1</span>, <span class='no'>u2</span>, <span class='kw'>family</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"kendall"</span>, <span class='kw'>B</span><span class='kw'>=</span><span class='fl'>50</span>)</div><div class='output co'>#&gt; $p.value.CvM
#&gt; [1] 0.78
#&gt; 
#&gt; $p.value.KS
#&gt; [1] 0.32
#&gt; 
#&gt; $statistic.CvM
#&gt; [1] 0.04426172
#&gt; 
#&gt; $statistic.KS
#&gt; [1] 0.7013749
#&gt; </div><div class='input'>
# perform Kendall's goodness-of-fit test for the Frank copula
</div><div class='input'><span class='fu'>BiCopGofTest</span>(<span class='no'>u1</span>, <span class='no'>u2</span>, <span class='kw'>family</span> <span class='kw'>=</span> <span class='fl'>5</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"kendall"</span>, <span class='kw'>B</span><span class='kw'>=</span><span class='fl'>50</span>)</div><div class='output co'>#&gt; $p.value.CvM
#&gt; [1] 0.02
#&gt; 
#&gt; $p.value.KS
#&gt; [1] 0.1
#&gt; 
#&gt; $statistic.CvM
#&gt; [1] 0.1498003
#&gt; 
#&gt; $statistic.KS
#&gt; [1] 0.7940009
#&gt; </div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Ulf Schepsmeier, Wanling Huang, Jiying Luo, Eike Brechmann</p>
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Ulf Schepsmeier, Jakob Stoeber, Eike Christian Brechmann, Benedikt Graeler, Thomas Nagler, Tobias Erhardt.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

