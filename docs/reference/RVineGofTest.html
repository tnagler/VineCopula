<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Goodness-of-Fit Tests for R-Vine Copula Models — RVineGofTest • VineCopula</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Goodness-of-Fit Tests for R-Vine Copula Models — RVineGofTest" />
<meta property="og:description" content="This function performs a goodness-of-fit test for R-vine copula models.
There are 15 different goodness-of-fit tests implemented, described in
Schepsmeier (2013)." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">VineCopula</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.4.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/tnagler/VineCopula/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Goodness-of-Fit Tests for R-Vine Copula Models</h1>
    <small class="dont-index">Source: <a href='https://github.com/tnagler/VineCopula/blob/master/R/RVineGofTest3.R'><code>R/RVineGofTest3.R</code></a></small>
    <div class="hidden name"><code>RVineGofTest.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function performs a goodness-of-fit test for R-vine copula models.
There are 15 different goodness-of-fit tests implemented, described in
Schepsmeier (2013).</p>
    </div>

    <pre class="usage"><span class='fu'>RVineGofTest</span>(
  <span class='no'>data</span>,
  <span class='no'>RVM</span>,
  <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"White"</span>,
  <span class='kw'>statistic</span> <span class='kw'>=</span> <span class='st'>"CvM"</span>,
  <span class='kw'>B</span> <span class='kw'>=</span> <span class='fl'>200</span>,
  <span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fl'>2</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>An N x d data matrix (with uniform margins).</p></td>
    </tr>
    <tr>
      <th>RVM</th>
      <td><p><code><a href='RVineMatrix.html'>RVineMatrix()</a></code> objects of the R-vine model under the
null hypothesis. <br />
Only the following copula families are allowed in
<code>RVM$family</code> due to restrictions in <code><a href='RVineGrad.html'>RVineGrad()</a></code> and
<code><a href='RVineHessian.html'>RVineHessian()</a></code> <br />
<code>0</code> = independence copula <br />
<code>1</code> = Gaussian copula <br />
<code>2</code> = Student t copula (t-copula)<br />
<code>3</code> = Clayton copula <br />
<code>4</code> = Gumbel copula <br />
<code>5</code> = Frank copula <br />
<code>6</code> = Joe copula <br />
<code>13</code> = rotated Clayton copula (180 degrees; <code>survival Clayton'') \cr `14` = rotated Gumbel copula (180 degrees; </code>survival Gumbel'') <br />
<code>16</code> = rotated Joe copula (180 degrees; ``survival Joe'') <br />
<code>23</code> = rotated Clayton copula (90 degrees) <br />
`24` = rotated Gumbel copula (90 degrees) <br />
`26` = rotated Joe copula (90 degrees) <br />
`33` = rotated Clayton copula (270 degrees) <br />
`34` = rotated Gumbel copula (270 degrees) <br />
`36` = rotated Joe copula (270 degrees) <br /></p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>A string indicating the goodness-of-fit method:<br />
<code>"White"</code> = goodness-of-fit test based on White's information matrix
equality (default) <br />
<code>"IR"</code> = goodness-of-fit test based on the
information ratio <br />
<code>"Breymann"</code> = goodness-of-fit test based on the
probability integral transform (PIT) and the aggregation to univariate data
by Breymann et al. (2003). <br />
<code>"Berg"</code> = goodness-of-fit test based on
the probability integral transform (PIT) and the aggregation to univariate
data by Berg and Bakken (2007). <br />
<code>"Berg2"</code> = second goodness-of-fit
test based on the probability integral transform (PIT) and the aggregation
to univariate data by Berg and Bakken (2007). <br />
<code>"ECP"</code> =
goodness-of-fit test based on the empirical copula process (ECP) <br />
<code>"ECP2"</code> = goodness-of-fit test based on the combination of probability
integral transform (PIT) and empirical copula process (ECP) (Genest et al.
2009) <br /></p></td>
    </tr>
    <tr>
      <th>statistic</th>
      <td><p>A string indicating the goodness-of-fit test statistic
type:<br /> <code>"CvM"</code> = Cramer-von Mises test statistic (univariate for
<code>"Breymann"</code>, <code>"Berg"</code> and <code>"Berg2"</code>, multivariate for
<code>"ECP"</code> and <code>"ECP2"</code>) <br /> <code>"KS"</code> = Kolmogorov-Smirnov test
statistic (univariate for <code>"Breymann"</code>, <code>"Berg"</code> and
<code>"Berg2"</code>, multivariate for <code>"ECP"</code> and <code>"ECP2"</code>) <br />
<code>"AD"</code> = Anderson-Darling test statistic (only univariate for
<code>"Breymann"</code>, <code>"Berg"</code> and <code>"Berg2"</code>)</p></td>
    </tr>
    <tr>
      <th>B</th>
      <td><p>an integer for the number of bootstrap steps (default <code>B = 200</code>)<br />
For <code>B = 0</code> the asymptotic p-value is returned if available,
otherwise only the test statistic is returned.<br />
WARNING: If <code>B</code> is chosen too large, computations will take very long.</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p>an integer of the set <code>2,4,6,...</code> for the <code>"Berg2"</code>
goodness-of-fit test (default <code>alpha = 2</code>)</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>For <code>method = "White"</code>:</p>
<dt>White</dt><dd><p>test statistic</p></dd>
<dt>p.value</dt><dd><p>p-value, either asymptotic for <code>B = 0</code> or bootstrapped
for <code>B &gt; 0</code></p></dd>
For method = "IR":
<dt>IR</dt><dd><p>test statistic (raw version as stated above)</p></dd>
<dt>p.value</dt><dd><p>So far no p-value is returned nigher a asymptotic nor a
bootstrapped one. How to calculated a bootstrapped p-value is explained in
Schepsmeier (2013). Be aware, that the test statistics than have to be adjusted
with the empirical variance.</p></dd>
For method = "Breymann", method = "Berg"
and method = "Berg2":
<dt>CvM, KS, AD</dt><dd><p>test statistic according to
the choice of <code>statistic</code></p></dd>
<dt>p.value</dt><dd><p>p-value, either asymptotic
for <code>B = 0</code> or bootstrapped for <code>B &gt; 0</code>.  A asymptotic p-value is
only available for the Anderson-Darling test statistic if the R-package
<code>ADGofTest</code> is loaded. <br />
Furthermore, a asymptotic p-value can be
calculated for the Kolmogorov-Smirnov test statistic. For the Cramer-von
Mises no asymptotic p-value is available so far.</p></dd>
For method = "ECP" and method = "ECP2":
<dt>CvM, KS</dt><dd><p>test statistic according to the
choice of <code>statistic</code></p></dd>
<dt>p.value</dt><dd><p>bootstrapped p-value</p></dd> 
Warning: The code for all the p-values are not yet approved since some of them are
moved from R-code to C-code. If you need p-values the best way is to write your own
algorithm as suggested in Schepsmeier (2013) to get bootstrapped p-values.

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>method = "White"</code>: <br />
This goodness-of fit test uses the information
matrix equality of White (1982) and was original investigated by Huang and
Prokhorov (2011) for copulas. <br />
Schepsmeier (2012) enhanced their approach
to the vine copula case. <br />
The main contribution is that under correct
model specification the Fisher Information can be equivalently calculated as
minus the expected Hessian matrix or as the expected outer product of the
score function.
The null hypothesis is
$$ H_0: \boldsymbol{H}(\theta) + \boldsymbol{C}(\theta) = 0 $$
against the alternative
$$ H_1: \boldsymbol{H}(\theta) +
\boldsymbol{C}(\theta) \neq 0 , $$
where
\(\boldsymbol{H}(\theta)\) is the expected Hessian matrix and
\(\boldsymbol{C}(\theta)\) is the expected outer product of the
score function. <br />
For the calculation of the test statistic we use the
consistent maximum likelihood estimator \(\hat{\theta}\) and the sample
counter parts of \(\boldsymbol{H}(\theta)\) and
\(\boldsymbol{C}(\theta)\). <br />
The correction of the
Covariance-Matrix in the test statistic for the uncertainty in the margins
is skipped. The implemented test assumes that there is no uncertainty in the
margins. The correction can be found in Huang and Prokhorov (2011) for
bivariate copulas and in Schepsmeier (2013) for vine copulas. It involves
multi-dimensional integrals. <br /></p>
<p><code>method = "IR"</code>: <br />
As the White test the information matrix ratio
test is based on the expected Hessian matrix
\(\boldsymbol{H}(\theta)\)
and the expected outer product of
the score function \(\boldsymbol{C}(\theta)\). <br />
$$ H_0:-\boldsymbol{H}(\theta)^{-1}\boldsymbol{C}(\theta) = I_{p} $$
against the alternative
$$ H_1:
-\boldsymbol{H}(\theta)^{-1}\boldsymbol{C}(\theta) \neq I_{p} . $$
The test statistic can then be calculated as
$$ IR_n:=tr(\Phi(\theta))/p $$ with
\(\Phi(\theta)=-\boldsymbol{H}(\theta)^{-1}\boldsymbol{C}(\theta)\),
\(p\) is the number of parameters, i.e. the length of \(\theta\), and
\(tr(A)\) is the trace of the matrix \(A\) <br />
For details see Schepsmeier (2013) <br /></p>
<p><code>method = "Breymann"</code>, <code>method = "Berg"</code> and <code>method = "Berg2"</code>: <br />
These tests are based on the multivariate probability integral
transform (PIT) applied in <code><a href='RVinePIT.html'>RVinePIT()</a></code>. The multivariate data
\(y_{i}\) returned form the PIT are aggregated to univariate data by
different aggregation functions \(\Gamma(\cdot)\) in the sum $$
s_t=\sum_{i=1}^d \Gamma(y_{it}), t=1,...,n $$.
In Breymann et al. (2003) the weight function is suggested as
\(\Gamma(\cdot)=\Phi^{-1}(\cdot)^2\), while in
Berg and Bakken (2007) the weight function is either
\(\Gamma(\cdot)=|\cdot-0.5|\) (<code>method="Berg"</code>) or
\(\Gamma(\cdot)=(\cdot-0.5)^{\alpha},\alpha=2,4,6,...\)
(<code>method="Berg2"</code>). <br /> Furthermore, the <code>"Berg"</code> and
<code>"Berg2"</code> test are based on the order statistics of the PIT returns.
<br /> See Berg and Bakken (2007) or Schepsmeier (2013) for details. <br /></p>
<p><code>method = "ECP"</code> and <code>method = "ECP2"</code>: <br />
Both tests are test
for \(H_0: C \in C_0\) against \(H_1: C \notin C_0\) where C denotes the
(vine) copula distribution function and \(C_0\) is a class of parametric
(vine) copulas with \(\Theta\subseteq R^p\) being the parameter space of
dimension p. They are based on the empirical copula process (ECP)
$$
\hat{C}_n(u)-C_{\hat{\theta}_n}(u), $$
with
\(u=(u_1,\ldots,u_d)\in[0,1]^d\) and
\(\hat{C}_n(u) =
\frac{1}{n+1}\sum_{t=1}^n \boldsymbol{1}_{\{U_{t1}\leq u_1,\ldots,U_{td}\leq
u_d \}} \).
The ECP is utilized in a multivariate
Cramer-von Mises (CvM) or multivariate Kolmogorov-Smirnov (KS) based test
statistic. An extension of the ECP-test is the combination of the
multivariate PIT approach with the ECP. The general idea is that the
transformed data of a multivariate PIT should be "close" to the independence
copula Genest et al. (2009). Thus a distance of CvM or KS type between them
is considered. This approach is called ECP2. Again we refer to Schepsmeier
(2013) for details.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Berg, D. and H. Bakken (2007) A copula goodness-of-fit approach
based on the conditional probability integral transformation.
<a href='https://www.danielberg.no/publications/Btest.pdf'>https://www.danielberg.no/publications/Btest.pdf</a></p>
<p>Breymann, W., A. Dias and P. Embrechts (2003) Dependence structures for
multivariate high-frequency data in finance. Quantitative Finance 3, 1-14</p>
<p>Genest, C., B. Remillard, and D. Beaudoin (2009) Goodness-of-fit tests for
copulas: a review and power study.  Insur. Math. Econ. 44, 199-213.</p>
<p>Huang, w. and A. Prokhorov (2011). A goodness-of-fit test for copulas. to
appear in Econometric Reviews</p>
<p>Schepsmeier, U. (2013) A goodness-of-fit test for regular vine copula
models.  Preprint <a href='https://arxiv.org/abs/1306.0818'>https://arxiv.org/abs/1306.0818</a></p>
<p>Schepsmeier, U. (2015) Efficient information based goodness-of-fit tests for
vine copula models with fixed margins. Journal of Multivariate Analysis 138,
34-52.</p>
<p>White, H. (1982) Maximum likelihood estimation of misspecified models,
Econometrica, 50, 1-26.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='BiCopGofTest.html'>BiCopGofTest()</a></code>, <code><a href='RVinePIT.html'>RVinePIT()</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>## time-consuming example</span>

<span class='co'># load data set</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>daxreturns</span>)

<span class='co'># select the R-vine structure, families and parameters</span>
<span class='no'>RVM</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='RVineStructureSelect.html'>RVineStructureSelect</a></span>(<span class='no'>daxreturns</span>[,<span class='fl'>1</span>:<span class='fl'>5</span>], <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>:<span class='fl'>6</span>))

<span class='co'># White test with asymptotic p-value</span>
<span class='fu'>RVineGofTest</span>(<span class='no'>daxreturns</span>[,<span class='fl'>1</span>:<span class='fl'>5</span>], <span class='no'>RVM</span>, <span class='kw'>B</span> <span class='kw'>=</span> <span class='fl'>0</span>)</div><div class='output co'>#&gt; $White
#&gt; [1] 120.5856
#&gt; 
#&gt; $p.value
#&gt; [1] 0.1418691
#&gt; </div><div class='input'>
<span class='co'># ECP2 test with Cramer-von-Mises test statistic and a bootstrap</span>
<span class='co'># with 200 replications for the calculation of the p-value</span>
<span class='fu'>RVineGofTest</span>(<span class='no'>daxreturns</span>[,<span class='fl'>1</span>:<span class='fl'>5</span>], <span class='no'>RVM</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"ECP2"</span>,
             <span class='kw'>statistic</span> <span class='kw'>=</span> <span class='st'>"CvM"</span>, <span class='kw'>B</span> <span class='kw'>=</span> <span class='fl'>200</span>)</div><div class='output co'>#&gt; $CvM
#&gt; [1] 0.1153089
#&gt; 
#&gt; $p.value
#&gt; [1] 0.69
#&gt; </div><div class='input'>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Thomas Nagler, Ulf Schepsmeier, Jakob Stoeber, Eike Christian Brechmann, Benedikt Graeler, Tobias Erhardt.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


